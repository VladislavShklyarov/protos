syntax = "proto3";

package order_service.v1;

import "protoc-gen-validate/validate/validate.proto";
import "google/protobuf/empty.proto";
import "google/api/annotations.proto";
import "google/api/http.proto";

option go_package = "github.com/VladislavShklyarov/protos/gen/order;orderservice";


message OrderStatusRequest { // Метод GetOrderStatus принимает order_id и user_id
  int64 user_id = 1 [(validate.rules).int64.gt = 0];
  string order_id = 2 [(validate.rules).string.min_len = 1];
}
message OrderStatusResponse { // ... и возвращает статус заказа
  OrderStatus order_status = 1;
}

message CreateOrderRequest { // Метод CreateOrder	принимает user_id, market_id, order_type, price и quantity
  int64 user_id = 1 [(validate.rules).int64.gt = 0];
  string market_id = 2 [(validate.rules).string.min_len = 1];
  OrderType order_type = 3  [(validate.rules).enum.defined_only = true];
  int64 price = 4 [(validate.rules).int64.gt = 0] ;
  int64 quantity = 5 [(validate.rules).int64.gt = 0];
}
message CreateOrderResponse { // ... и возвращает order_id и статус
  string order_id = 1 [(validate.rules).string.min_len = 1];
  OrderStatus order_status = 2;
}


service OrderService {
  rpc GetOrderStatus(OrderStatusRequest) returns (OrderStatusResponse) {
    option (google.api.http) = {
      get: "/orders/{order_id}"
    };
  }
  rpc CreateOrder(CreateOrderRequest) returns (CreateOrderResponse) {
    option (google.api.http) = {
      post: "/orders"
      body: "*"
    };
  }
}



enum OrderType {
  ORDER_TYPE_UNSPECIFIED = 0;
  ORDER_TYPE_BUY = 1;
  ORDER_TYPE_SELL = 2;
}

enum OrderStatus {
  ORDER_STATUS_UNSPECIFIED = 0;
  ORDER_STATUS_CREATED = 1;
  ORDER_STATUS_EXECUTED = 2;
  ORDER_STATUS_REJECTED = 3;
}
