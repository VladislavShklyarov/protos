syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "protoc-gen-validate/validate/validate.proto";
import "google/api/http.proto";
import "google/api/annotations.proto";


package spot_instrument.v1;

option go_package = "github.com/VladislavShklyarov/protos/gen/spot_instrument;spotinstrument";

message ViewMarketsRequest {
  repeated UseRoles user_roles = 1 [
    (validate.rules).repeated = {
      min_items: 1
      items {
        enum {
          defined_only: true
          not_in: [0]
        }
      }
    }
  ];
}

  message ViewMarketsResponse {
  repeated Market markets = 1; // ... и возвращает список доступных рынков
}

message Market {// "структура Рынок"
  string id = 1;
  string name = 2;
  bool enabled = 3;
  google.protobuf.Timestamp deleted_at = 4;
}

service SpotInstrumentService  {
  rpc ViewMarkets(ViewMarketsRequest) returns (ViewMarketsResponse) {
    option (google.api.http) = {
      get: "/markets"
    };
  }
}
// Пока что самый базовый функционал с одним rpc который проверяет доступность рынка в зависимости от роли пользователя.
// Может потом добавим что-нибудь еще, например функционал работы с рынками или что-то в таком духе.

enum UseRoles {
  UNDEFINED = 0;
  RETAIL_TRADER = 1;
  INSTITUTIONAL_TRADER = 2;
  MARKET_MAKER = 3;
  READ_ONLY = 4;
}